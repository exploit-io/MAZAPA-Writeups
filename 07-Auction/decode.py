import requests
import string



def get_cipher(new_char):
    global headers, cookies
    paramsPost = {"input_text":decoded + new_char,"encrypted_text":""}
    response = requests.post("http://auction.petromaz.ir/tool", data=paramsPost, headers=headers, cookies=cookies)
    result = response.text
    start = result.find("0x")
    end = result.find("</textarea>", start)
    result = result[start:end]
    return result

def main():
    global decoded, cipher
    result = ""
    while len(result) < len(cipher):
        for char in string.printable:
            result = get_cipher(char)
            if cipher.startswith(result):
                decoded += char
                print("[+] - Found: " + decoded)
                continue
            # else:
            #     print("[-] - Not Yet: " + decoded + char)

if __name__ == "__main__":
    global decoded, cipher, headers, cookies
    # decoded = "--------------TRy-------------------------------------------------------Harder---------------------------------------------------------------Or-Harder?--"
    decoded = "--------------TRy-------------------------------------------------------Harder---------------------------------------------------------------Or-Harder?-------------------"
    
    cipher = "0xcf0xa50x4d0xbd0x820x930x200xd90xbd0x810x350x3f0x0b0x260x6d0x240xa00x1d0xa30x790x9f0x380x4d0x3b0xb40xdb0x390x700x1f0x900xec0x010xa60x1b0xf70xc10x4d0x230x190x600xd30x6f0x700x3c0xaf0xeb0xf70x200x1a0xde0x7a0xb50xf00x790x4e0x960x8d0xc10x600x230x0a0x900xd40x730x590x300x020xde0x5a0x340x2d0xdd0x420xf90xd90x2b0x7d0x400x300x440x760x8a0x840xd00xef0xb60x830xef0x440xe30x930xca0x1d0x150x4f0x770x3c0x580xbe0x760x550xf40x4d0x9c0x960xb60xf90xc90xfb0xae0xdf0x050x260xd60x1d0xed0x880x250xcb0x6c0x270x9c0x8b0xda0x830x450x960x660x010xd70x350xcd0xff0xc30x500x700x0d0x6a0xc50x5e0x520xad0xe70x7e0xe00x910xb50x350x250x520xa80x190xf50x8c0x870xf10x140xe90xb10x360xf60xa60xa50xcb0x680xbf0x480x9d0x1d0x470xd80xba0xf90xca0xfd0x580x3d0x800x6b0xa30x080xc90x8f0xbe0x8b0x500xc80x610x5d0x180x3b0xa40x7d0xc80xd20xa70xc10x0a0x470x3d0xcb0xa30x240x8e0x5d0x510x440x8a0xca0x560xaa0x110x530xe30x6d0x140x920xe10x2c0x2e0xb00x1f0x350x340x650x1a0x770x090xe10x880x4c0xdc0x750xb60x230xf90x0f0x930xdf0x030xdc0xfd0xcc0x520x710x6a0xe0"
    headers = {"Origin":"http://auction.petromaz.ir","Accept":"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8","Upgrade-Insecure-Requests":"1","User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:124.0) Gecko/20100101 Firefox/124.0","Connection":"close","Referer":"http://auction.petromaz.ir/tool","Accept-Language":"en-US,en;q=0.5","Accept-Encoding":"gzip, deflate, br","Content-Type":"application/x-www-form-urlencoded"}
    cookies = {"token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ1c2VybmFtZSI6ImJvYiJ9.OC5bmcbCZgZ6p6-MHTw-kXH62M5GZiFe90af8BShJagccGVszxIxTVC7ybrddq-dgngPL5oyNVqCvQFcS9QE22yTB5MkaJnmP-oD1aiu4MYwgsF7UfLMUf2m2t1xP31gDGSD0kSHg8uuxswxWuXdz8AS1P6L7m2hyYTo6_5B6eXaRq6VmDNU_RrF4QK9R620Qd0J1hwVaWrokz3UdUcr0NUtGmdN1jlA2Vt8RIYm48SzLAQeViLQ4Br3HxiGWDXHdDEr0hVY0Jna6yJsBoOfc7jJurJRkWD2Kgyj1sDI-ZQXJg5UolfC26vnfwp7jcSsYDrm4GjnVqrcaVjBeb3tAw"}
    main()
